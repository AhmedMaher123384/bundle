module.exports = [
  "(function(){",
  "var g=null;try{g=globalThis}catch(e){g=window}if(!g)g=window;",
  "g.BundleApp=g.BundleApp||{};",
  "var debug=false;try{debug=new URL(scriptSrc).searchParams.get(\"debug\")===\"1\"}catch(e){}",
  "function warn(){if(!debug)return;try{console.warn.apply(console,arguments)}catch(e){}}",
  "function getBackendOrigin(){try{return new URL(scriptSrc).origin}catch(e){return\"\"}}",
  "function buildUrl(path,params){var origin=getBackendOrigin();if(!origin)return null;var u=new URL(origin+path);for(var k in (params||{})){if(!Object.prototype.hasOwnProperty.call(params,k))continue;var v=params[k];if(v==null||v===\"\")continue;u.searchParams.set(k,String(v))}u.searchParams.set(\"merchantId\",merchantId);u.searchParams.set(\"token\",token);return u.toString()}",
  "async function fetchJson(url,opts){var r=await fetch(url,opts||{});var t=await r.text();var j=null;try{j=t?JSON.parse(t):null}catch(e){throw new Error(\"Invalid JSON response\")}if(!r.ok){var msg=(j&&j.message)||(\"HTTP \"+r.status);var err=new Error(msg);err.status=r.status;err.details=j;throw err}return j}",
  "function postJson(url,body){return fetchJson(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body||{})})}",
  "function pageLang(){try{var el=document&&document.documentElement;var b=document&&document.body;var l=(el&&el.getAttribute&&el.getAttribute('lang'))||(b&&b.getAttribute&&b.getAttribute('lang'))||'';return String(l||'').toLowerCase()}catch(e){return ''}}",
  "function isArabic(){try{var l=pageLang();if(l&&l.indexOf('ar')===0)return true;var nl=String((navigator&&navigator.language)||'').toLowerCase();return nl&&nl.indexOf('ar')===0}catch(e){return false}}",
  "function isRtl(){try{var d=(document&&document.documentElement&&document.documentElement.dir)||'';if(d&&String(d).toLowerCase()==='rtl')return true;var bd=(document&&document.body&&document.body.dir)||'';if(bd&&String(bd).toLowerCase()==='rtl')return true;var cs=window.getComputedStyle?window.getComputedStyle(document.body||document.documentElement):null;var dir=cs&&cs.direction?String(cs.direction).toLowerCase():'';if(dir==='rtl')return true;return isArabic()}catch(e){return false}}",
  "function ensureOnce(){try{if(g.BundleApp&&g.BundleApp.__mediaPlatformMounted)return false;g.BundleApp.__mediaPlatformMounted=true;return true}catch(e){return true}}",
  "function findFooterEl(){try{return document.querySelector('footer')||document.querySelector('[role=\"contentinfo\"]')||document.querySelector('#footer')||document.querySelector('.footer')||null}catch(e){return null}}",
  "function setFabVisible(btn,on){try{btn.style.opacity=on?'1':'0';btn.style.pointerEvents=on?'auto':'none';btn.style.transform=on?'translateY(0)':'translateY(10px)'}catch(e){}}",
  "function setupFabFooterReveal(btn){try{var footer=findFooterEl();if(!footer){setFabVisible(btn,true);return}function applyInView(inView){setFabVisible(btn,!!inView)}try{var io=new IntersectionObserver(function(entries){try{var e=(entries&&entries[0])||null;applyInView(!!(e&&e.isIntersecting&&e.intersectionRatio>0))}catch(x){}},{root:null,threshold:[0,0.01,0.1]});io.observe(footer);setTimeout(function(){try{var r=footer.getBoundingClientRect();applyInView(r.top<window.innerHeight&&r.bottom>0)}catch(e){}},0)}catch(e){function check(){try{var r=footer.getBoundingClientRect();applyInView(r.top<window.innerHeight&&r.bottom>0)}catch(x){}}window.addEventListener('scroll',check,{passive:true});window.addEventListener('resize',check,{passive:true});setTimeout(check,0)}}catch(e){try{setFabVisible(btn,true)}catch(x){}}}",
  "function createFab(){var btn=document.createElement('button');btn.type='button';btn.setAttribute('aria-label',isArabic()?'منصة الرفع':'Upload platform');btn.style.position='fixed';btn.style.bottom='10px';btn.style.left='12px';btn.style.zIndex='100002';btn.style.border='1px solid rgba(24,181,213,.55)';btn.style.cursor='pointer';btn.style.borderRadius='999px';btn.style.background='#292929';btn.style.color='#fff';btn.style.boxShadow='0 14px 34px rgba(0,0,0,.28)';btn.style.display='grid';btn.style.placeItems='center';btn.style.userSelect='none';btn.style.webkitUserSelect='none';btn.style.lineHeight='1';btn.style.fontWeight='900';btn.style.transition='opacity .18s ease,transform .18s ease,filter .18s ease';btn.style.opacity='0';btn.style.pointerEvents='none';btn.style.transform='translateY(10px)';btn.onmouseenter=function(){btn.style.filter='brightness(1.05)'};btn.onmouseleave=function(){btn.style.filter=''};var icon=document.createElementNS('http://www.w3.org/2000/svg','svg');icon.setAttribute('viewBox','0 0 24 24');icon.setAttribute('aria-hidden','true');icon.style.display='block';icon.style.color='#fff';var path=document.createElementNS('http://www.w3.org/2000/svg','path');path.setAttribute('fill','currentColor');path.setAttribute('d','M12 2l3.09 6.26 6.91 1.01-5 4.87 1.18 6.88L12 17.77 5.82 21.02 7 14.14 2 9.27l6.91-1.01L12 2z');icon.appendChild(path);btn.appendChild(icon);function applySize(){try{var vw=Math.min(Number(window.innerWidth||0)||0,Number(window.innerHeight||0)||0);var s=vw&&vw<380?42:48;btn.style.width=s+'px';btn.style.height=s+'px';btn.style.padding='0';var isSmall=s<46;icon.setAttribute('width',isSmall?'18':'20');icon.setAttribute('height',isSmall?'18':'20')}catch(e){}}applySize();try{window.addEventListener('resize',applySize,{passive:true})}catch(e){};return btn}",
  "function buildSheet(){var overlay=document.createElement('div');overlay.className='bundle-app-bottomsheet';overlay.style.alignItems='flex-end';overlay.style.justifyContent='center';overlay.style.padding='10px';overlay.style.zIndex='100003';var panel=document.createElement('div');panel.className='bundle-app-bottomsheet__panel';panel.style.width='min(760px,100%)';panel.style.maxHeight='85vh';panel.style.overflow='auto';var head=document.createElement('div');head.className='bundle-app-bottomsheet__head';var title=document.createElement('div');title.className='bundle-app-bottomsheet__title';title.textContent=isArabic()?'منصة الرفع':'Media platform';var close=document.createElement('button');close.type='button';close.textContent=isArabic()?'إغلاق':'Close';close.style.padding='6px 10px';close.style.borderRadius='10px';close.style.border='1px solid rgba(15,23,42,.12)';close.style.background='#fff';close.style.color='#0b1220';close.style.fontSize='13px';close.style.fontWeight='900';head.appendChild(title);head.appendChild(close);var body=document.createElement('div');body.style.padding='0 14px 14px';var topRow=document.createElement('div');topRow.style.display='flex';topRow.style.alignItems='center';topRow.style.justifyContent='space-between';topRow.style.gap='10px';topRow.style.flexWrap='wrap';topRow.style.padding='0 0 12px';var tabs=document.createElement('div');tabs.style.display='flex';tabs.style.gap='8px';tabs.style.flexWrap='wrap';var actions=document.createElement('div');actions.style.display='flex';actions.style.gap='8px';actions.style.flexWrap='wrap';topRow.appendChild(tabs);topRow.appendChild(actions);var uploads=document.createElement('div');uploads.style.display='none';uploads.style.flexDirection='column';uploads.style.gap='8px';uploads.style.marginBottom='10px';var content=document.createElement('div');content.style.display='flex';content.style.flexDirection='column';content.style.gap='12px';body.appendChild(topRow);body.appendChild(uploads);body.appendChild(content);panel.appendChild(head);panel.appendChild(body);overlay.appendChild(panel);return {overlay:overlay,closeBtn:close,tabs:tabs,actions:actions,uploads:uploads,content:content}}",
  "function pill(label,active){var b=document.createElement('button');b.type='button';b.textContent=label;b.style.border='1px solid rgba(15,23,42,.12)';b.style.background=active?'#0f172a':'#fff';b.style.color=active?'#fff':'#0b1220';b.style.padding='9px 12px';b.style.borderRadius='999px';b.style.fontSize='13px';b.style.fontWeight='900';b.style.cursor='pointer';b.style.boxShadow=active?'0 14px 30px rgba(2,6,23,.14)':'0 10px 24px rgba(0,0,0,.06)';return b}",
  "function btnPrimary(label){var b=document.createElement('button');b.type='button';b.textContent=label;b.style.border='0';b.style.cursor='pointer';b.style.padding='10px 12px';b.style.borderRadius='12px';b.style.background='#0f172a';b.style.color='#fff';b.style.fontWeight='900';b.style.fontSize='13px';b.style.boxShadow='0 18px 40px rgba(2,6,23,.16)';return b}",
  "function btnGhost(label){var b=document.createElement('button');b.type='button';b.textContent=label;b.style.border='1px solid rgba(15,23,42,.12)';b.style.cursor='pointer';b.style.padding='10px 12px';b.style.borderRadius='12px';b.style.background='#fff';b.style.color='#0b1220';b.style.fontWeight='900';b.style.fontSize='13px';b.style.boxShadow='0 10px 24px rgba(0,0,0,.06)';return b}",
  "function fmtBytes(n){var b=Number(n);if(!Number.isFinite(b)||b<0)return'';if(b<1024)return b+' B';var kb=b/1024;if(kb<1024)return kb.toFixed(1)+' KB';var mb=kb/1024;if(mb<1024)return mb.toFixed(1)+' MB';var gb=mb/1024;return gb.toFixed(2)+' GB'}",
  "function renderEmpty(){var wrap=document.createElement('div');wrap.style.border='1px dashed rgba(15,23,42,.18)';wrap.style.borderRadius='14px';wrap.style.padding='16px';wrap.style.background='rgba(15,23,42,.02)';wrap.style.color='rgba(15,23,42,.8)';wrap.style.fontSize='13px';wrap.style.fontWeight='900';wrap.textContent=isArabic()?'مفيش ملفات مرفوعة لحد دلوقتي.':'No media uploaded yet.';return wrap}",
  "function renderError(msg){var wrap=document.createElement('div');wrap.style.border='1px solid rgba(225,29,72,.22)';wrap.style.borderRadius='14px';wrap.style.padding='16px';wrap.style.background='rgba(225,29,72,.06)';wrap.style.color='#881337';wrap.style.fontSize='13px';wrap.style.fontWeight='900';wrap.textContent=String(msg||'Error');return wrap}",
  "function renderLoading(){var wrap=document.createElement('div');wrap.style.border='1px solid rgba(15,23,42,.10)';wrap.style.borderRadius='14px';wrap.style.padding='14px';wrap.style.background='#fff';wrap.style.color='rgba(15,23,42,.75)';wrap.style.fontSize='13px';wrap.style.fontWeight='900';wrap.textContent=isArabic()?'جاري التحميل...':'Loading...';return wrap}",
  "function renderUploadRow(rec){var wrap=document.createElement('div');wrap.style.display='flex';wrap.style.flexDirection='column';wrap.style.gap='8px';wrap.style.padding='10px 12px';wrap.style.borderRadius='14px';wrap.style.border='1px solid rgba(15,23,42,.10)';wrap.style.background='#fff';wrap.style.boxShadow='0 10px 22px rgba(0,0,0,.06)';var row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.justifyContent='space-between';row.style.gap='10px';var left=document.createElement('div');left.style.minWidth='0';left.style.display='flex';left.style.flexDirection='column';left.style.gap='4px';var name=document.createElement('div');name.style.fontSize='12px';name.style.fontWeight='950';name.style.color='#0b1220';name.style.overflow='hidden';name.style.textOverflow='ellipsis';name.style.whiteSpace='nowrap';name.textContent=String(rec.name||'');var sub=document.createElement('div');sub.style.fontSize='12px';sub.style.fontWeight='900';sub.style.color=rec.status==='error'?'#881337':'rgba(15,23,42,.70)';sub.textContent=rec.status==='uploading'?(isArabic()?'جاري الرفع...':'Uploading...'):rec.status==='done'?(isArabic()?'تم الرفع':'Uploaded'):rec.status==='error'?String(rec.error||'Error'):(isArabic()?'في الانتظار':'Queued');left.appendChild(name);left.appendChild(sub);var right=document.createElement('div');right.style.display='flex';right.style.alignItems='center';right.style.gap='10px';right.style.flex='0 0 auto';var meta=document.createElement('div');meta.style.fontSize='12px';meta.style.fontWeight='900';meta.style.color='rgba(15,23,42,.70)';meta.textContent=rec.size?fmtBytes(rec.size):'';right.appendChild(meta);row.appendChild(left);row.appendChild(right);wrap.appendChild(row);var url=String((rec&&rec.url)||'');if(url&&rec.status==='done'){var linkRow=document.createElement('div');linkRow.style.display='flex';linkRow.style.alignItems='center';linkRow.style.justifyContent='space-between';linkRow.style.gap='10px';var a=document.createElement('a');a.href=url;a.target='_blank';a.rel='noopener noreferrer';a.textContent=url;a.style.flex='1 1 auto';a.style.minWidth='0';a.style.overflow='hidden';a.style.textOverflow='ellipsis';a.style.whiteSpace='nowrap';a.style.direction='ltr';a.style.fontSize='12px';a.style.fontWeight='900';a.style.color='#0f172a';a.style.textDecoration='underline';a.style.textDecorationThickness='2px';a.style.textUnderlineOffset='3px';var copy=document.createElement('button');copy.type='button';copy.textContent=isArabic()?'نسخ':'Copy';copy.style.flex='0 0 auto';copy.style.border='0';copy.style.cursor='pointer';copy.style.padding='6px 10px';copy.style.borderRadius='10px';copy.style.background='#18b5d5';copy.style.color='#fff';copy.style.fontSize='12px';copy.style.fontWeight='950';copy.onclick=function(){try{var text=String(url||'');if(!text)return;function fallback(){try{window.prompt('Copy link',text)}catch(e){}}if(navigator&&navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(text).then(function(){copy.textContent=isArabic()?'تم النسخ':'Copied';setTimeout(function(){copy.textContent=isArabic()?'نسخ':'Copy'},1200)}).catch(function(){fallback()})}else{fallback()}}catch(e){}};linkRow.appendChild(a);linkRow.appendChild(copy);wrap.appendChild(linkRow)}return wrap}",
  "function renderGrid(items){var grid=document.createElement('div');grid.style.display='grid';grid.style.gridTemplateColumns='repeat(2,minmax(0,1fr))';grid.style.gap='10px';grid.style.alignItems='stretch';grid.style.marginTop='4px';for(var i=0;i<items.length;i++){var it=items[i]||{};var card=document.createElement('div');card.style.border='1px solid rgba(15,23,42,.10)';card.style.borderRadius='14px';card.style.overflow='hidden';card.style.background='#fff';card.style.boxShadow='0 10px 22px rgba(0,0,0,.06)';var media=document.createElement('div');media.style.width='100%';media.style.aspectRatio='16 / 10';media.style.background='rgba(2,6,23,.06)';media.style.display='flex';media.style.alignItems='center';media.style.justifyContent='center';media.style.overflow='hidden';if(String(it.resourceType)==='video'){var v=document.createElement('video');v.controls=true;v.playsInline=true;v.preload='metadata';v.src=String(it.secureUrl||it.url||'');v.style.width='100%';v.style.height='100%';v.style.objectFit='cover';media.appendChild(v)}else{var img=document.createElement('img');img.alt='';img.loading='lazy';img.decoding='async';img.referrerPolicy='no-referrer';img.src=String(it.secureUrl||it.url||'');img.style.width='100%';img.style.height='100%';img.style.objectFit='cover';media.appendChild(img)};var meta=document.createElement('div');meta.style.padding='10px';meta.style.display='flex';meta.style.flexDirection='column';meta.style.gap='6px';var line1=document.createElement('div');line1.style.display='flex';line1.style.alignItems='center';line1.style.justifyContent='space-between';line1.style.gap='10px';var name=document.createElement('div');name.style.fontSize='12px';name.style.fontWeight='950';name.style.color='#0b1220';name.style.overflow='hidden';name.style.textOverflow='ellipsis';name.style.whiteSpace='nowrap';name.textContent=String(it.originalFilename||it.publicId||'');var badge=document.createElement('div');badge.style.fontSize='11px';badge.style.fontWeight='950';badge.style.padding='5px 8px';badge.style.borderRadius='999px';badge.style.background='rgba(15,23,42,.06)';badge.style.color='#0b1220';badge.textContent=String(it.resourceType||'');line1.appendChild(name);line1.appendChild(badge);var line2=document.createElement('div');line2.style.display='flex';line2.style.alignItems='center';line2.style.justifyContent='space-between';line2.style.gap='10px';line2.style.fontSize='12px';line2.style.color='rgba(15,23,42,.75)';var size=document.createElement('div');size.textContent=fmtBytes(it.bytes);var open=document.createElement('a');open.href=String(it.secureUrl||it.url||'#');open.target='_blank';open.rel='noopener noreferrer';open.textContent=isArabic()?'فتح':'Open';open.style.fontWeight='950';open.style.textDecoration='underline';line2.appendChild(size);line2.appendChild(open);meta.appendChild(line1);meta.appendChild(line2);card.appendChild(media);card.appendChild(meta);grid.appendChild(card)};return grid}",
  "function copyText(text,onDone){try{var t=String(text||'');if(!t)return;function ok(){try{if(onDone)onDone(true)}catch(e){}}function bad(){try{if(onDone)onDone(false)}catch(e){}}function fallback(){try{window.prompt(isArabic()?'انسخ الرابط':'Copy link',t)}catch(e){}bad()}if(navigator&&navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(t).then(function(){ok()}).catch(function(){fallback()})}else{fallback()}}catch(e){}}",
  "function renderLinkBlock(url){var u=String(url||'');if(!u)return null;var wrap=document.createElement('div');wrap.style.display='flex';wrap.style.alignItems='stretch';wrap.style.gap='10px';wrap.style.padding='10px';wrap.style.borderRadius='12px';wrap.style.border='1px solid rgba(24,181,213,.35)';wrap.style.background='#292929';wrap.style.boxShadow='0 10px 22px rgba(0,0,0,.14)';var a=document.createElement('a');a.href=u;a.target='_blank';a.rel='noopener noreferrer';a.textContent=u;a.style.flex='1 1 auto';a.style.minWidth='0';a.style.overflow='hidden';a.style.textOverflow='ellipsis';a.style.whiteSpace='nowrap';a.style.direction='ltr';a.style.fontSize='14px';a.style.fontWeight='950';a.style.color='#18b5d5';a.style.textDecoration='underline';a.style.textDecorationThickness='2px';a.style.textUnderlineOffset='3px';var copy=document.createElement('button');copy.type='button';copy.textContent=isArabic()?'انسخ الرابط':'Copy link';copy.style.flex='0 0 auto';copy.style.border='0';copy.style.cursor='pointer';copy.style.padding='10px 14px';copy.style.borderRadius='10px';copy.style.background='#18b5d5';copy.style.color='#fff';copy.style.fontSize='13px';copy.style.fontWeight='950';copy.style.boxShadow='0 12px 26px rgba(0,0,0,.20)';copy.onclick=function(){try{var prev=isArabic()?'انسخ الرابط':'Copy link';copyText(u,function(done){copy.textContent=done?(isArabic()?'تم النسخ':'Copied'):(isArabic()?'انسخ الرابط':'Copy link');setTimeout(function(){copy.textContent=prev},1200)})}catch(e){}};wrap.appendChild(a);wrap.appendChild(copy);return wrap}",
  "function renderUploadRow(rec){var wrap=document.createElement('div');wrap.style.display='flex';wrap.style.flexDirection='column';wrap.style.gap='10px';wrap.style.padding='12px';wrap.style.borderRadius='14px';wrap.style.border='1px solid rgba(24,181,213,.25)';wrap.style.background='#292929';wrap.style.boxShadow='0 10px 22px rgba(0,0,0,.14)';var row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.justifyContent='space-between';row.style.gap='10px';var left=document.createElement('div');left.style.minWidth='0';left.style.display='flex';left.style.flexDirection='column';left.style.gap='4px';var name=document.createElement('div');name.style.fontSize='12px';name.style.fontWeight='950';name.style.color='#fff';name.style.overflow='hidden';name.style.textOverflow='ellipsis';name.style.whiteSpace='nowrap';name.textContent=String(rec.name||'');var sub=document.createElement('div');sub.style.fontSize='12px';sub.style.fontWeight='900';sub.style.color=rec.status==='error'?'#fff':'rgba(255,255,255,.78)';sub.textContent=rec.status==='uploading'?(isArabic()?'جاري الرفع...':'Uploading...'):rec.status==='done'?(isArabic()?'تم الرفع':'Uploaded'):rec.status==='error'?String(rec.error||'Error'):(isArabic()?'في الانتظار':'Queued');left.appendChild(name);left.appendChild(sub);var right=document.createElement('div');right.style.display='flex';right.style.alignItems='center';right.style.gap='10px';right.style.flex='0 0 auto';var meta=document.createElement('div');meta.style.fontSize='12px';meta.style.fontWeight='900';meta.style.color='rgba(255,255,255,.78)';meta.textContent=rec.size?fmtBytes(rec.size):'';right.appendChild(meta);row.appendChild(left);row.appendChild(right);wrap.appendChild(row);var url=String((rec&&rec.url)||'');if(url&&rec.status==='done'){var block=renderLinkBlock(url);if(block)wrap.appendChild(block)}return wrap}",
  "function renderGrid(items){var grid=document.createElement('div');grid.style.display='grid';grid.style.gridTemplateColumns='repeat(2,minmax(0,1fr))';grid.style.gap='10px';grid.style.alignItems='stretch';grid.style.marginTop='4px';for(var i=0;i<items.length;i++){var it=items[i]||{};var src=String(it.secureUrl||it.url||'');var card=document.createElement('div');card.style.border='1px solid rgba(24,181,213,.20)';card.style.borderRadius='14px';card.style.overflow='hidden';card.style.background='#292929';card.style.boxShadow='0 10px 22px rgba(0,0,0,.14)';var media=document.createElement('div');media.style.width='100%';media.style.aspectRatio='16 / 10';media.style.background='rgba(255,255,255,.06)';media.style.display='flex';media.style.alignItems='center';media.style.justifyContent='center';media.style.overflow='hidden';if(String(it.resourceType)==='video'){var v=document.createElement('video');v.controls=true;v.playsInline=true;v.preload='metadata';v.src=src;v.style.width='100%';v.style.height='100%';v.style.objectFit='cover';media.appendChild(v)}else{var img=document.createElement('img');img.alt='';img.loading='lazy';img.decoding='async';img.referrerPolicy='no-referrer';img.src=src;img.style.width='100%';img.style.height='100%';img.style.objectFit='cover';media.appendChild(img)}var meta=document.createElement('div');meta.style.padding='10px';meta.style.display='flex';meta.style.flexDirection='column';meta.style.gap='10px';var top=document.createElement('div');top.style.display='flex';top.style.alignItems='center';top.style.justifyContent='space-between';top.style.gap='10px';var name=document.createElement('div');name.style.flex='1 1 auto';name.style.minWidth='0';name.style.fontSize='12px';name.style.fontWeight='950';name.style.color='#fff';name.style.overflow='hidden';name.style.textOverflow='ellipsis';name.style.whiteSpace='nowrap';name.textContent=String(it.originalFilename||it.publicId||'');var badge=document.createElement('div');badge.style.flex='0 0 auto';badge.style.fontSize='11px';badge.style.fontWeight='950';badge.style.padding='5px 8px';badge.style.borderRadius='999px';badge.style.border='1px solid rgba(24,181,213,.35)';badge.style.background='rgba(24,181,213,.10)';badge.style.color='#fff';badge.textContent=(String(it.resourceType||'')||'media').toUpperCase();top.appendChild(name);top.appendChild(badge);meta.appendChild(top);if(src){var block=renderLinkBlock(src);if(block)meta.appendChild(block)}card.appendChild(media);card.appendChild(meta);grid.appendChild(card)}return grid}",
  "async function loadAssets(resourceType,page,limit){var url=buildUrl('/api/proxy/media/assets',{resourceType:resourceType||'',page:page||1,limit:limit||24});if(!url)throw new Error('Missing backend origin');return await fetchJson(url)}",
  "async function getSignature(resourceType){var url=buildUrl('/api/proxy/media/signature',{});if(!url)throw new Error('Missing backend origin');return await postJson(url,{resourceType:resourceType||'image'})}",
  "async function recordAsset(cloud){var url=buildUrl('/api/proxy/media/assets',{});if(!url)throw new Error('Missing backend origin');return await postJson(url,{cloudinary:cloud})}",
  "async function uploadToCloudinary(file,sign){var c=sign&&sign.cloudinary?sign.cloudinary:null;if(!c||!c.uploadUrl||!c.apiKey||!c.signature||!c.timestamp||!c.folder)throw new Error('Invalid signature');var fd=new FormData();fd.append('file',file);fd.append('api_key',String(c.apiKey));fd.append('timestamp',String(c.timestamp));fd.append('signature',String(c.signature));fd.append('folder',String(c.folder));if(c.tags)fd.append('tags',String(c.tags));if(c.context)fd.append('context',String(c.context));var r=await fetch(String(c.uploadUrl),{method:'POST',body:fd});var j=await r.json().catch(function(){return null});if(!r.ok){var msg=(j&&j.error&&j.error.message)||('Upload failed');throw new Error(msg)}return j}",
  "function mount(){try{if(!ensureOnce())return;try{if(typeof ensureStyles==='function')ensureStyles()}catch(e){};var fab=createFab();try{setupFabFooterReveal(fab)}catch(e){};var sheetEl=null;fab.onclick=function(){try{if(sheetEl)return;var sheet=buildSheet();sheetEl=sheet.overlay;var input=document.createElement('input');input.type='file';input.multiple=true;input.accept='image/*,video/*';input.style.display='none';document.body.appendChild(input);function close(){try{if(sheetEl)sheetEl.remove()}catch(e){}try{if(input&&input.remove)input.remove()}catch(e){}sheetEl=null}sheet.closeBtn.onclick=close;sheet.overlay.addEventListener('click',function(ev){try{if(ev.target===sheet.overlay)close()}catch(e){}});var state={type:'',page:1,limit:24,loading:false,items:[],total:0,error:'',uploads:[],uploading:false};function setTab(t){state.type=t||'';state.page=1;state.items=[];state.total=0;state.error='';render();fetchAndRender()}async function fetchAndRender(){if(state.loading)return;state.loading=true;render();try{var data=await loadAssets(state.type,state.page,state.limit);var items=Array.isArray(data&&data.items)?data.items:[];state.total=Number(data&&data.total||0)||0;if(state.page===1)state.items=items;else state.items=state.items.concat(items);state.loading=false;render()}catch(err){state.loading=false;state.error=String((err&&err.message)||err||'');render()}}async function runUploads(files){if(state.uploading)return;state.uploading=true;state.uploads=[];for(var i=0;i<files.length;i++){var f=files[i];if(!f)continue;state.uploads.push({name:String(f.name||''),size:Number(f.size||0)||0,status:'queued',error:'',url:''})}render();for(var j=0;j<files.length;j++){var file=files[j];if(!file)continue;var rec=state.uploads[j];try{rec.status='uploading';rec.error='';rec.url='';render();var rt=(String(file.type||'').indexOf('video')===0)?'video':'image';var sign=await getSignature(rt);var uploaded=await uploadToCloudinary(file,sign);await recordAsset(uploaded);rec.url=String((uploaded&&(uploaded.secure_url||uploaded.url))||'');rec.status='done';render()}catch(e){rec.status='error';rec.error=String((e&&e.message)||e||'Error');render()}}state.uploading=false;render();setTab(state.type)}input.onchange=function(){try{var fs=input.files?Array.prototype.slice.call(input.files):[];input.value='';if(!fs.length)return;runUploads(fs)}catch(e){}};function render(){try{sheet.tabs.innerHTML='';sheet.actions.innerHTML='';sheet.uploads.innerHTML='';sheet.content.innerHTML='';var labels=isArabic()?{all:'الكل',img:'صور',vid:'فيديو',up:'رفع ملفات',ref:'تحديث'}:{all:'All',img:'Images',vid:'Videos',up:'Upload',ref:'Refresh'};var allBtn=pill(labels.all,state.type==='');var imgBtn=pill(labels.img,state.type==='image');var vidBtn=pill(labels.vid,state.type==='video');allBtn.onclick=function(){setTab('')};imgBtn.onclick=function(){setTab('image')};vidBtn.onclick=function(){setTab('video')};sheet.tabs.appendChild(allBtn);sheet.tabs.appendChild(imgBtn);sheet.tabs.appendChild(vidBtn);var uploadBtn=btnPrimary(labels.up);uploadBtn.onclick=function(){try{input.click()}catch(e){}};var refreshBtn=btnGhost(labels.ref);refreshBtn.onclick=function(){fetchAndRender()};sheet.actions.appendChild(uploadBtn);sheet.actions.appendChild(refreshBtn);if(state.uploads.length){sheet.uploads.style.display='flex';for(var i=0;i<state.uploads.length;i++)sheet.uploads.appendChild(renderUploadRow(state.uploads[i]));}else{sheet.uploads.style.display='none'}if(state.loading&&state.page===1)sheet.content.appendChild(renderLoading());if(state.error)sheet.content.appendChild(renderError(state.error));if(!state.loading&&!state.error){if(!state.items.length)sheet.content.appendChild(renderEmpty());else sheet.content.appendChild(renderGrid(state.items));if(state.total>state.items.length){var more=btnPrimary(isArabic()?'تحميل المزيد':'Load more');more.onclick=function(){state.page+=1;fetchAndRender()};sheet.content.appendChild(more)}}}catch(e){}}document.body.appendChild(sheet.overlay);render();fetchAndRender()}catch(e){warn('media platform open failed',e);try{if(sheetEl)sheetEl.remove()}catch(x){}sheetEl=null}};document.body.appendChild(fab)}catch(e){warn('media platform mount failed',e)}}",
  "try{mount()}catch(e){}",
  "})();"
];
